name: Replace Links

on:
  workflow_dispatch:
    inputs:
      old_link:
        description: '–°—Ç–∞—Ä–∞—è —Å—Å—ã–ª–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://vw63et-82-204-189-161.ru.tuna.am)'
        required: true
        type: string
      new_link:
        description: '–ù–æ–≤–∞—è —Å—Å—ã–ª–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://lt60mh-95-164-118-165.ru.tuna.am)'
        required: true
        type: string

jobs:
  replace:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Replace old links with new ones
        run: |
          echo "–ó–∞–º–µ–Ω—è–µ–º: ${{ inputs.old_link }} -> ${{ inputs.new_link }}"
          find . -type f ! -path "./.git/*" -exec sed -i "s|${{ inputs.old_link }}|${{ inputs.new_link }}|g" {} +

      - name: Commit and push changes
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add .
          git commit -m "üîÅ –ó–∞–º–µ–Ω–∏–ª —Å—Å—ã–ª–∫–∏: ${{ inputs.old_link }} ‚Üí ${{ inputs.new_link }}" || echo "–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
          git push
