<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Личный кабинет партнера</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .order { background: white; padding: 15px; margin: 10px 0; border: 1px solid #ccc; }
        button { padding: 8px; margin-top: 5px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>

<h2>Личный кабинет</h2>
<div id="ordersContainer">Загрузка заказов...</div>

<script>
let tg = window.Telegram.WebApp;
tg.expand();

function loadOrders() {
    fetch("https://your-backend-url/api/orders", {  // здесь подставишь свой backend для загрузки заказов
        method: "GET",
    }).then(response => response.json()).then(data => {
        const container = document.getElementById("ordersContainer");
        container.innerHTML = "";

        if (data.length === 0) {
            container.innerHTML = "Пока нет заказов.";
            return;
        }

        data.forEach(order => {
            let div = document.createElement("div");
            div.className = "order";
            div.innerHTML = `
                <strong>Заказ №${order.id}</strong><br>
                Город: ${order.city}<br>
                Описание: ${order.description}<br>
                <img src="${order.image_url}" style="width: 100%; margin: 5px 0;"><br>
                <textarea id="comment-${order.id}" placeholder="Комментарий для клиента"></textarea>
                <button onclick="acceptOrder(${order.id})">Взять в работу</button>
            `;
            container.appendChild(div);
        });
    }).catch(error => {
        document.getElementById("ordersContainer").innerText = "Ошибка загрузки заказов.";
    });
}

function acceptOrder(orderId) {
    let comment = document.getElementById(`comment-${orderId}`).value;

    let data = {
        action: "accept_order",
        order_id: orderId,
        comment: comment,
        price: prompt("Введите стоимость выполнения заказа")
    };

    Telegram.WebApp.sendData(JSON.stringify(data));
    Telegram.WebApp.close();
}

loadOrders();
</script>

</body>
</html>
