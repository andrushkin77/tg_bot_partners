<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="styles.css">
    <title>Регистрация партнера</title>
</head>
<body>
    <h2>Регистрация партнера</h2>
    <input type="text" id="name" placeholder="Название">
    <input type="text" id="location" placeholder="Адрес">
    <textarea id="description" placeholder="Описание"></textarea>
    <input type="file" id="photos" multiple>
    <input type="email" id="email" placeholder="E-mail">
    <input type="password" id="password" placeholder="Пароль">
    <button onclick="register()">Зарегистрироваться</button>
    <script>
        function register() {
            const formData = new FormData();
            formData.append('name', document.getElementById('name').value);
            formData.append('location', document.getElementById('location').value);
            formData.append('description', document.getElementById('description').value);
            formData.append('email', document.getElementById('email').value);
            formData.append('password', document.getElementById('password').value);
            formData.append('tgUserId', Telegram.WebApp.initDataUnsafe.user.id);

            const files = document.getElementById('photos').files;
            for (let i = 0; i < files.length; i++) {
                formData.append('photos', files[i]);
            }

            fetch('/register', { method: 'POST', body: formData })
                .then(res => res.json())
                .then(res => {
                    if (res.success) {
                        Telegram.WebApp.openLink("dashboard.html");
                    } else {
                        alert("Ошибка: " + res.message);
                    }
                });
        }
    </script>
</body>
</html>
